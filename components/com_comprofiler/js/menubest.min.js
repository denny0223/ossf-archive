var vertical=false;var nbmenu=3;var centrer_menu=false;var largeur_menu=95;var hauteur_menu=25;var largeur_sous_menu=150;var largeur_auto_ssmenu=true;var espace_entre_menus=5;var cbMenuAnchorReference="1";var cbMenuAnchorOffsetx=0;var cbMenuAnchorOffsety=0;var top_menu=10;var bb_top_menu_to_ssmenu=23;var top_ssmenu=top_menu+bb_top_menu_to_ssmenu;var left_menu=10;var bb_right_menu_to_ssmenu=10;var left_ssmenu=left_menu+largeur_menu+bb_right_menu_to_ssmenu;var delai=650;var bbAddMarginsToDoc=false;var marge_en_haut_de_page=top_menu+40;var marge_a_gauche_de_la_page=largeur_menu+10;var suivre_le_scroll=false;var cacher_les_select=true;var timeout;var agt=navigator.userAgent.toLowerCase();var isMac=(agt.indexOf("mac")!=-1);var isOpera=(agt.indexOf("opera")!=-1);var IEver=parseInt(agt.substring(agt.indexOf("msie ")+5),10);var isIE=((agt.indexOf("msie")!=-1&&!isOpera&&(agt.indexOf("webtv")==-1))&&!isMac);var isIE5win=(isIE&&IEver==5);var isIE5mac=((agt.indexOf("msie")!=-1)&&isMac);var blnOk=true;var reg=new RegExp("px","g");window.onscroll=function(){if(blnOk&&suivre_le_scroll&&(isIE||isIE5mac)){if(isIE5mac){document.getElementById("conteneurmenu").style.visibility="hidden"}var a=0;for(i=1;i<=nbmenu;i++){if(!vertical){document.getElementById("menu"+i).style.top=document.body.scrollTop+top_menu+"px";if(document.getElementById("ssmenu"+i)){document.getElementById("ssmenu"+i).style.top=document.body.scrollTop+top_ssmenu+"px"}}else{document.getElementById("menu"+i).style.top=document.body.scrollTop+(((i-1)*espace_entre_menus)+a+1+top_menu)+"px";if(document.getElementById("ssmenu"+i)){document.getElementById("ssmenu"+i).style.top=document.body.scrollTop+(((i-1)*espace_entre_menus)+a+1+top_menu)+"px"}a+=isFinite(hauteur_menu)?hauteur_menu:hauteur_menu[i-1]}}if(isIE5mac){document.getElementById("conteneurmenu").style.visibility="visible"}}};function preChargement(){if(document.getElementById("conteneurmenu")){document.getElementById("conteneurmenu").style.visibility="hidden"}}function Chargement(){if(cbMenuAnchorReference!=="1"){bbsetMenuLocation(document)}if(!blnOk){if(document.body.style.backgroundColor!=""){blnOk=false}if(document.body.style.color!=""){blnOk=false}if(document.body.style.marginTop!=""){blnOk=false}if(document.getElementById){with(document.getElementById("conteneurmenu").style){if(position!=""||top!=""||left!=""||width!=""||height!=""||zIndex!=""||margin!=""||visibility!=""){blnOk=false;alert("BB:ko1")}}}else{blnOk=false}}if(blnOk){document.getElementById("conteneurmenu").style.visibility="hidden";trimespaces();if(bbAddMarginsToDoc){with(document.body.style){if(!vertical){marginTop=marge_en_haut_de_page+"px"}else{marginLeft=marge_a_gauche_de_la_page+"px"}}}positionne();CacherMenus()}document.getElementById("conteneurmenu").style.visibility=""}window.onresize=Chargement;function positionne(){var largeur_fenetre=(isIE?document.body.clientWidth:window.innerWidth);var hauteur_fenetre=(isIE?document.body.clientHeight:window.innerHeight);if(centrer_menu){if(!vertical){var largeur_totale=espace_entre_menus*(nbmenu-1);if(isFinite(largeur_menu)){largeur_totale+=largeur_menu*nbmenu}else{for(i=1;i<=nbmenu;i++){largeur_totale+=largeur_menu[i-1]}}left_menu=(largeur_fenetre-largeur_totale)/2}else{var hauteur_totale=espace_entre_menus*(nbmenu-1);if(isFinite(hauteur_menu)){hauteur_totale+=hauteur_menu*nbmenu}else{for(i=1;i<=nbmenu;i++){hauteur_totale+=hauteur_menu[i-1]}}top_menu=(hauteur_fenetre-hauteur_totale)/2}}var i,cumul=0;if(cbMenuAnchorReference!=="1"){for(i=1;i<=nbmenu;i++){with(document.getElementById("menu"+i).style){if(!vertical){top=top_menu+"px";left=(((i-1)*espace_entre_menus)+cumul+left_menu)+"px"}else{top=(((i-1)*espace_entre_menus)+cumul+top_menu)+"px";left=left_menu+"px"}if(!suivre_le_scroll||isIE||isIE5mac){position="absolute"}else{position="fixed"}margin="0";zIndex="2";if(vertical||isFinite(largeur_menu)){width=largeur_menu+"px"}else{width=largeur_menu[i-1]+"px"}if((!vertical&&isFinite(largeur_menu))||(vertical&&isFinite(hauteur_menu))){cumul+=(!vertical?largeur_menu:hauteur_menu)}else{cumul+=(!vertical?largeur_menu[i-1]:hauteur_menu[i-1]);if(vertical){height=hauteur_menu[i-1]+"px"}}}}}cumul=0;for(i=1;i<=nbmenu;i++){if(document.getElementById("ssmenu"+i)){with(document.getElementById("ssmenu"+i).style){if(cbMenuAnchorReference!=="1"){if(!suivre_le_scroll||isIE||isIE5mac){position="absolute"}else{position="fixed"}if(!vertical){top=top_ssmenu+"px";left=(((i-1)*espace_entre_menus)+cumul+1+left_menu)+"px"}else{left=left_ssmenu+"px";top=(((i-1)*espace_entre_menus)+cumul+1+top_menu)+"px"}}if(isIE5mac||!largeur_auto_ssmenu){if(isFinite(largeur_sous_menu)){width=largeur_sous_menu+(largeur_sous_menu!="auto"?"px":"")}else{width=largeur_sous_menu[i-1]+(largeur_sous_menu[i-1]!="auto"?"px":"")}}else{if(cbMenuAnchorReference!=="1"){width="auto"}}if(cbMenuAnchorReference!=="1"){if(!vertical&&!isIE5mac){if((width!="auto")&&((left.replace(reg,"").valueOf()*1+width.replace(reg,"").valueOf()*1)>largeur_fenetre)){left=(largeur_fenetre-width.replace(reg,"").valueOf())+"px"}}margin="0";zIndex="3"}}}if(cbMenuAnchorReference!=="1"){if((!vertical&&isFinite(largeur_menu))||(vertical&&isFinite(hauteur_menu))){cumul+=(!vertical?largeur_menu:hauteur_menu)}else{cumul+=(!vertical?largeur_menu[i-1]:hauteur_menu[i-1])}}}}function MontrerMenu(strMenu){if(blnOk){AnnulerCacher();CacherMenus();if(document.getElementById(strMenu)){with(document.getElementById(strMenu).style){visibility="visible"}}}SelectVisible("hidden",document.getElementsByTagName("select"))}function CacherDelai(){if(blnOk){timeout=setTimeout("CacherMenus()",delai)}}function AnnulerCacher(){if(blnOk&&timeout){clearTimeout(timeout)}}function CacherMenus(){if(blnOk){for(i=1;i<=nbmenu;i++){if(document.getElementById("ssmenu"+i)){with(document.getElementById("ssmenu"+i).style){visibility="hidden"}}}}SelectVisible("visible",document.getElementsByTagName("select"))}function trimespaces(){if(blnOk&&isIE5win){for(i=1;i<=nbmenu;i++){if(document.getElementById("ssmenu"+i)){with(document.getElementById("ssmenu"+i)){innerHTML=innerHTML.replace(/<LI>|<\/LI>/g,"")}}}}}function SelectVisible(a,c){if(blnOk&&cacher_les_select&&(isIE||isIE5win)){for(var b=0;b<c.length;b++){c[b].style.visibility=a}}}function bbsetMenuLocation(a){var b;if(cbMenuAnchorReference=="1"){cbMenuAnchorReference="conteneurmenu"}b=bbgetLocation(cbMenuAnchorReference,a);if(b){top_menu=b[1];left_menu=b[0];top_ssmenu=top_menu+bb_top_menu_to_ssmenu;left_ssmenu=left_menu+largeur_menu+bb_right_menu_to_ssmenu}}function bbgetLocation(b,c){var a;var d=bbgetRefById(b,c.document);if(!d){alert('WARNING: menu anchor id="'+b+'" not found in html.');return null}else{a=bbgetAnchorLocation(d)}return a}function bbgetAnchorLocation(e){var c,d,b,a;c=a=e;b=[cbMenuAnchorOffsetx,cbMenuAnchorOffsety];if(document.layers){if(typeof a.length!="undefined"&&a.length>1){c=a[0];b[0]+=a[0].x+a[1].pageX;b[1]+=a[0].y+a[1].pageY}else{if(a.toString().indexOf("Image")!=-1||a.toString().indexOf("Anchor")!=-1){b[0]+=a.x;b[1]+=a.y}else{b[0]+=a.pageX;b[1]+=a.pageY}}}else{b[0]+=bbpageLocation(a,"Left");b[1]+=bbpageLocation(a,"Top")}return b}function bbpageLocation(c,b){var a=0;while(c){a+=c["offset"+b];c=c.offsetParent}return a}function bbgetRefById(a,e){var c="",b;e=(e||document);if(e.all){return e.all[a]}else{if(e.getElementById){return e.getElementById(a)}else{if(e.layers&&e.layers.length>0){if(e.layers[a]){return e.layers[a]}for(b=0;b<e.layers.length;b++){c=getRefById(a,e.layers[b].document);if(c){return c}}}}}return false}function bbgetRefByName(a,e){var c=null,b;e=(e||document);if(e.images[a]){return e.images[a]}else{if(e.anchors[a]){return e.anchors[a]}else{if(e.layers&&e.layers.length>0){for(b=0;b<e.layers.length;b++){c=getRefByName(a,e.layers[b].document);if(c&&c.length>0){return c}else{if(c){return[c,e.layers[b]]}}}}}}return null};